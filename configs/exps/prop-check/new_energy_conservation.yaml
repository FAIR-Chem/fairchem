job:
  mem: 32GB
  cpus: 4
  gres: gpu:rtx8000:1
  partition: long

default:
  test_ri: True
  cp_data_to_tmp: true
  mode: train
  graph_rewiring: remove-tag-0
  model:
    energy_head: weighted-av-final-embeds
  fa_frames: random
  frame_averaging: 2D
  wandb_tags: 'rebuttal'
  optim:
    batch_size: 120
    eval_batch_size: 120
    scheduler: LinearWarmupCosineAnnealingLR
    max_epochs: 4

runs:
  - config: faenet-s2ef-2M
    note: 'Direct'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 1
    model: 
      regress_forces: direct
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'Direct_with_grad'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 1
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'From energy'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 1
    model: 
      regress_forces: from_energy
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'Energy + EC'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 0
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'Energy + Force'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 0
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False


  - config: faenet-s2ef-2M
    note: 'EC bigger coeff'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 20
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'Force + EC'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 0
      energy_grad_coefficient: 1
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: faenet-s2ef-2M
    note: 'Force no EC'
    optim:
      lr_initial: 0.00028
      max_epochs: 6
      force_coefficient: 30
      energy_coefficient: 0
      energy_grad_coefficient: 0
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False