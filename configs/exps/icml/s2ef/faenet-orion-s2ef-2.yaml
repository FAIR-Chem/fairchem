job:
  mem: 48GB
  cpus: 4
  gres: gpu:1
  partition: long
  code_loc: /home/mila/a/alexandre.duval/ocp/ocp-test/ocp
  env: ocp-a100

default:
  wandb_project: ocp-4
  config: faenet-s2ef-2M
  mode: train
  test_ri: true
  wandb_tags: s2ef-2M, orion
  cp_data_to_tmpdir: true
  graph_rewiring: remove-tag-0
  model:
    edge_embed_type: all_rij
    graph_norm: True
    energy_head: weighted-av-final-embeds
  frame_averaging: 2D
  fa_frames: random
  optim:
    scheduler: LinearWarmupCosineAnnealingLR
    energy_coefficient: 1
  note:
    model: name, num_gaussians, hidden_channels, num_filters, num_interactions, phys_embeds, pg_hidden_channels, phys_hidden_channels, tag_hidden_channels, energy_head, edge_embed_type, mp_type, graph_norm, complex_mp, att_heads, second_layer_MLP, skip_co
    optim: lr_initial, warmup_steps
    _root_: frame_averaging, fa_frames
  orion_mult_factor:
    value: 32
    targets: hidden_channels, num_filters, pg_hidden_channels, phys_hidden_channels, tag_hidden_channels

orion:
  # Remember to change the experiment name if you change anything in the search space
  n_jobs: 50

  unique_exp_name: faenet-s2ef-2M-rebuttal

  space:
    model/complex_mp: choices([True, False])
    model/fa_frames: choices(["random", "se3-random"])
    model/cutoff: choices([5.0, 6.0, 7.0])
    model/hidden_channels: uniform(7, 19, discrete=True)
    model/mp_type: choices(["base", "updownscale", "updownscale_base"])
    model/num_filters: uniform(3, 18, discrete=True)
    model/num_gaussians: uniform(40, 140, discrete=True)
    model/num_interactions: uniform(3, 7, discrete=True)
    model/pg_hidden_channels: uniform(0, 3, discrete=True)
    model/phys_embeds: choices([True, False])
    model/regress_forces: choices(["direct_with_gradient_target", "direct"])
    model/second_layer_MLP: choices([True, False])
    model/skip_co: choices(["concat", False])
    model/tag_hidden_channels: uniform(0, 2, discrete=True)
    model/max_num_neighbors: choices([30,40,50])
    model/force_decoder_type: choices(["mlp", "res", "res_updown", "simple"])
    model/force_decoder_model_config/mlp/hidden_channels: uniform(6, 12, discrete=True)
    optim/lr_initial: loguniform(1e-4, 5e-4, precision=2)
    optim/force_coefficient: choices([30, 50, 75])
    optim/energy_grad_coef: choices([1, 5, 10])
    optim/max_epochs: fidelity(8, 25, base=6)

  algorithms:
    asha:
      seed: 123
      num_rungs: 4
      num_brackets: 2
