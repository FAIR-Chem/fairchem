job:
  mem: 32GB
  cpus: 4
  gres: gpu:rtx8000:1
  partition: long

default:
  test_ri: True
  cp_data_to_tmp: true
  mode: train
  graph_rewiring: remove-tag-0
  model:
    energy_head: weighted-av-final-embeds
  fa_frames: random
  frame_averaging: 2D
  wandb_tags: 'rebuttal'
  optim:
    batch_size: 192
    eval_batch_size: 192
    scheduler: LinearWarmupCosineAnnealingLR
    max_epochs: 10
    fidelity_max_epochs: 21

runs:
  - config: faenet-s2ef-2M
    note: 'force head mlp 1'
    optim:
      lr_initial: 0.00028
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False
      force_decoder_type: mlp
      force_decoder_model_config:
        mlp:
          hidden_channels: 356

  - config: faenet-s2ef-2M
    note: 'force head res'
    optim:
      lr_initial: 0.00028
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False
      force_decoder_type: res

  - config: faenet-s2ef-2M
    note: 'force head res updown'
    optim:
      lr_initial: 0.00028
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False
      force_decoder_type: res_updown

  - config: faenet-s2ef-2M
    note: 'force head res'
    optim:
      lr_initial: 0.00027
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 30
      graph_norm: True
      mp_type: updownscale_base
      hidden_channels: 256
      num_gaussians: 136
      num_filters: 480
      num_interactions: 7
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: "concat"
      second_layer_mlp: False
      complex_mp: True
      force_decoder_type: res

  - config: faenet-s2ef-2M
    note: 'force head res updown'
    optim:
      lr_initial: 0.00027
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 30
      graph_norm: True
      mp_type: updownscale_base
      hidden_channels: 256
      num_gaussians: 136
      num_filters: 480
      num_interactions: 7
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: "concat"
      second_layer_mlp: False
      complex_mp: True
      force_decoder_type: res_updown

  - config: faenet-s2ef-2M
    note: 'force head res simple'
    optim:
      lr_initial: 0.00027
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 30
      graph_norm: True
      mp_type: updownscale_base
      hidden_channels: 256
      num_gaussians: 136
      num_filters: 480
      num_interactions: 7
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: "concat"
      second_layer_mlp: False
      complex_mp: True
      force_decoder_type: simple


  - config: faenet-s2ef-2M
    note: 'force head res'
    optim:
      lr_initial: 0.00022
      max_epochs: 12
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: False
      mp_type: updownscale
      hidden_channels: 480
      num_gaussians: 148
      num_filters: 384
      num_interactions: 4
      pg_hidden_channels: 64
      tag_hidden_channels: 64
      phys_embeds: False
      skip_co: "concat"
      second_layer_mlp: True
      complex_mp: False
      force_decoder_type: res

  - config: faenet-s2ef-2M
    note: 'force head res'
    optim:
      lr_initial: 0.00022
      max_epochs: 12
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: False
      mp_type: updownscale
      hidden_channels: 480
      num_gaussians: 148
      num_filters: 384
      num_interactions: 4
      pg_hidden_channels: 64
      tag_hidden_channels: 64
      phys_embeds: False
      skip_co: "concat"
      second_layer_mlp: True
      complex_mp: False
      force_decoder_type: res_updown

  - config: faenet-s2ef-2M
    note: 'force head res'
    optim:
      lr_initial: 0.00022
      max_epochs: 12
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: False
      mp_type: updownscale
      hidden_channels: 480
      num_gaussians: 148
      num_filters: 384
      num_interactions: 4
      pg_hidden_channels: 64
      tag_hidden_channels: 64
      phys_embeds: False
      skip_co: "concat"
      second_layer_mlp: True
      complex_mp: False
      force_decoder_type: simple