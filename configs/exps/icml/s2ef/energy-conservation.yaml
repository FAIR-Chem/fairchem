job:
  mem: 32GB
  cpus: 4
  gres: gpu:rtx8000:1
  partition: long

default:
  test_ri: True
  cp_data_to_tmp: true
  mode: train
  graph_rewiring: remove-tag-0
  model:
    energy_head: weighted-av-final-embeds
  fa_frames: random
  frame_averaging: 2D
  wandb_tags: 'rebuttal'
  optim:
    batch_size: 192
    eval_batch_size: 192
    scheduler: LinearWarmupCosineAnnealingLR
    max_epochs: 10

runs:
  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test direct'
    optim:
      lr_initial: 0.00028
      max_epochs: 16
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test'
    optim:
      lr_initial: 0.00028
      max_epochs: 16
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test'
    optim:
      lr_initial: 0.00028
      max_epochs: 16
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 5
    model: 
      regress_forces: from_energy
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False

  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test high grad and force coef'
    optim:
      lr_initial: 0.00028
      max_epochs: 16
      force_coefficient: 100
      energy_coefficient: 1
      energy_grad_coefficient: 20
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 4
      max_num_neighbors: 40
      graph_norm: True
      mp_type: base
      hidden_channels: 352
      num_gaussians: 79
      num_filters: 96
      num_interactions: 4
      pg_hidden_channels: 96
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: False
      second_layer_mlp: False
      complex_mp: False




  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test 2'
    optim:
      lr_initial: 0.00027
      max_epochs: 10
      fidelity_max_epochs: 22
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 40
      graph_norm: True
      mp_type: updownscale_base
      hidden_channels: 256
      num_gaussians: 136
      num_filters: 480
      num_interactions: 7
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: concat
      second_layer_mlp: False
      complex_mp: True

  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test 2'
    optim:
      lr_initial: 0.00027
      max_epochs: 10
      fidelity_max_epochs: 22
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 40
      graph_norm: True
      mp_type: updownscale_base
      hidden_channels: 256
      num_gaussians: 136
      num_filters: 480
      num_interactions: 7
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: concat
      second_layer_mlp: False
      complex_mp: True

  - config: sfarinet-s2ef-2M
    note: 'Rebuttal test 3'
    optim:
      lr_initial: 0.00019
      max_epochs: 20
      force_coefficient: 30
      energy_coefficient: 1
      energy_grad_coefficient: 10
    model: 
      regress_forces: direct_with_gradient_target
      cutoff: 6
      max_num_neighbors: 40
      graph_norm: False
      mp_type: updownscale_base
      hidden_channels: 544
      num_gaussians: 124
      num_filters: 576
      num_interactions: 5
      pg_hidden_channels: 64
      tag_hidden_channels: 32
      phys_embeds: True
      skip_co: concat
      second_layer_mlp: True
      complex_mp: True