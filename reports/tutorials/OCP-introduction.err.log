Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
re3 = -2.58  # O -> 1/2 O2         re3 = -2.58 eV

from ase import Atoms

atoms = Atoms(sfcc['symbols'],
              positions=sfcc['pos'],
              cell=sfcc['cell'],
              pbc=True)
    
atoms.set_calculator(calc)
opt = BFGS(atoms)

opt.run(fmax=0.05, steps=100)
re2 = atoms.get_potential_energy()
    
nO = 0
for atom in atoms:
    if atom.symbol == 'O':
        nO += 1
        re2 += re1 + re3

print(re2 / nO)
------------------

----- stderr -----
/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/amp/autocast_mode.py:250: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[8], line 13[0m
[1;32m     10[0m atoms[38;5;241m.[39mset_calculator(calc)
[1;32m     11[0m opt [38;5;241m=[39m BFGS(atoms)
[0;32m---> 13[0m [43mopt[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43mfmax[49m[38;5;241;43m=[39;49m[38;5;241;43m0.05[39;49m[43m,[49m[43m [49m[43msteps[49m[38;5;241;43m=[39;49m[38;5;241;43m100[39;49m[43m)[49m
[1;32m     14[0m re2 [38;5;241m=[39m atoms[38;5;241m.[39mget_potential_energy()
[1;32m     16[0m nO [38;5;241m=[39m [38;5;241m0[39m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/optimize/optimize.py:269[0m, in [0;36mOptimizer.run[0;34m(self, fmax, steps)[0m
[1;32m    267[0m [38;5;28;01mif[39;00m steps:
[1;32m    268[0m     [38;5;28mself[39m[38;5;241m.[39mmax_steps [38;5;241m=[39m steps
[0;32m--> 269[0m [38;5;28;01mreturn[39;00m [43mDynamics[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/optimize/optimize.py:156[0m, in [0;36mDynamics.run[0;34m(self)[0m
[1;32m    149[0m [38;5;28;01mdef[39;00m [38;5;21mrun[39m([38;5;28mself[39m):
[1;32m    150[0m [38;5;250m    [39m[38;5;124;03m"""Run dynamics algorithm.[39;00m
[1;32m    151[0m 
[1;32m    152[0m [38;5;124;03m    This method will return when the forces on all individual[39;00m
[1;32m    153[0m [38;5;124;03m    atoms are less than *fmax* or when the number of steps exceeds[39;00m
[1;32m    154[0m [38;5;124;03m    *steps*."""[39;00m
[0;32m--> 156[0m [43m    [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mconverged[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43mDynamics[49m[38;5;241;43m.[39;49m[43mirun[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m[43m:[49m
[1;32m    157[0m [43m        [49m[38;5;28;43;01mpass[39;49;00m
[1;32m    158[0m     [38;5;28;01mreturn[39;00m converged

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/optimize/optimize.py:122[0m, in [0;36mDynamics.irun[0;34m(self)[0m
[1;32m    111[0m [38;5;250m[39m[38;5;124;03m"""Run dynamics algorithm as generator. This allows, e.g.,[39;00m
[1;32m    112[0m [38;5;124;03mto easily run two optimizers or MD thermostats at the same time.[39;00m
[1;32m    113[0m 
[0;32m   (...)[0m
[1;32m    118[0m [38;5;124;03m>>>     opt1.run()[39;00m
[1;32m    119[0m [38;5;124;03m"""[39;00m
[1;32m    121[0m [38;5;66;03m# compute initial structure and log the first step[39;00m
[0;32m--> 122[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43matoms[49m[38;5;241;43m.[39;49m[43mget_forces[49m[43m([49m[43m)[49m
[1;32m    124[0m [38;5;66;03m# yield the first time to inspect before logging[39;00m
[1;32m    125[0m [38;5;28;01myield[39;00m [38;5;28;01mFalse[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/atoms.py:788[0m, in [0;36mAtoms.get_forces[0;34m(self, apply_constraint, md)[0m
[1;32m    786[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_calc [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    787[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m'[39m[38;5;124mAtoms object has no calculator.[39m[38;5;124m'[39m)
[0;32m--> 788[0m forces [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_calc[49m[38;5;241;43m.[39;49m[43mget_forces[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m
[1;32m    790[0m [38;5;28;01mif[39;00m apply_constraint:
[1;32m    791[0m     [38;5;66;03m# We need a special md flag here because for MD we want[39;00m
[1;32m    792[0m     [38;5;66;03m# to skip real constraints but include special "constraints"[39;00m
[1;32m    793[0m     [38;5;66;03m# Like Hookean.[39;00m
[1;32m    794[0m     [38;5;28;01mfor[39;00m constraint [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mconstraints:

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/calculators/abc.py:23[0m, in [0;36mGetPropertiesMixin.get_forces[0;34m(self, atoms)[0m
[1;32m     22[0m [38;5;28;01mdef[39;00m [38;5;21mget_forces[39m([38;5;28mself[39m, atoms[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[0;32m---> 23[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mget_property[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mforces[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43matoms[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/ase/calculators/calculator.py:737[0m, in [0;36mCalculator.get_property[0;34m(self, name, atoms, allow_calculation)[0m
[1;32m    735[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m allow_calculation:
[1;32m    736[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 737[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcalculate[49m[43m([49m[43matoms[49m[43m,[49m[43m [49m[43m[[49m[43mname[49m[43m][49m[43m,[49m[43m [49m[43msystem_changes[49m[43m)[49m
[1;32m    739[0m [38;5;28;01mif[39;00m name [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mresults:
[1;32m    740[0m     [38;5;66;03m# For some reason the calculator was not able to do what we want,[39;00m
[1;32m    741[0m     [38;5;66;03m# and that is OK.[39;00m
[1;32m    742[0m     [38;5;28;01mraise[39;00m PropertyNotImplementedError([38;5;124m'[39m[38;5;132;01m{}[39;00m[38;5;124m not present in this [39m[38;5;124m'[39m
[1;32m    743[0m                                       [38;5;124m'[39m[38;5;124mcalculation[39m[38;5;124m'[39m[38;5;241m.[39mformat(name))

File [0;32m~/work/ocp/ocp/ocpmodels/common/relaxation/ase_utils.py:225[0m, in [0;36mOCPCalculator.calculate[0;34m(self, atoms, properties, system_changes)[0m
[1;32m    222[0m data_object [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39ma2g[38;5;241m.[39mconvert(atoms)
[1;32m    223[0m batch [38;5;241m=[39m data_list_collater([data_object], otf_graph[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[0;32m--> 225[0m predictions [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtrainer[49m[38;5;241;43m.[39;49m[43mpredict[49m[43m([49m[43mbatch[49m[43m,[49m[43m [49m[43mper_image[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m[43m [49m[43mdisable_tqdm[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m)[49m
[1;32m    227[0m [38;5;28;01mfor[39;00m key [38;5;129;01min[39;00m predictions:
[1;32m    228[0m     _pred [38;5;241m=[39m predictions[key]

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/utils/_contextlib.py:115[0m, in [0;36mcontext_decorator.<locals>.decorate_context[0;34m(*args, **kwargs)[0m
[1;32m    112[0m [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)
[1;32m    113[0m [38;5;28;01mdef[39;00m [38;5;21mdecorate_context[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    114[0m     [38;5;28;01mwith[39;00m ctx_factory():
[0;32m--> 115[0m         [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/work/ocp/ocp/ocpmodels/trainers/ocp_trainer.py:433[0m, in [0;36mOCPTrainer.predict[0;34m(self, data_loader, per_image, results_file, disable_tqdm)[0m
[1;32m    425[0m [38;5;28;01mfor[39;00m _i, batch [38;5;129;01min[39;00m tqdm(
[1;32m    426[0m     [38;5;28menumerate[39m(data_loader),
[1;32m    427[0m     total[38;5;241m=[39m[38;5;28mlen[39m(data_loader),
[0;32m   (...)[0m
[1;32m    430[0m     disable[38;5;241m=[39mdisable_tqdm,
[1;32m    431[0m ):
[1;32m    432[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mcuda[38;5;241m.[39mamp[38;5;241m.[39mautocast(enabled[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mscaler [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m):
[0;32m--> 433[0m         out [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_forward[49m[43m([49m[43mbatch[49m[43m)[49m
[1;32m    435[0m     [38;5;28;01mfor[39;00m target_key [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mconfig[[38;5;124m"[39m[38;5;124moutputs[39m[38;5;124m"[39m]:
[1;32m    436[0m         pred [38;5;241m=[39m out[target_key]

File [0;32m~/work/ocp/ocp/ocpmodels/trainers/ocp_trainer.py:234[0m, in [0;36mOCPTrainer._forward[0;34m(self, batch)[0m
[1;32m    233[0m [38;5;28;01mdef[39;00m [38;5;21m_forward[39m([38;5;28mself[39m, batch):
[0;32m--> 234[0m     out [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmodel[49m[43m([49m[43mbatch[49m[38;5;241;43m.[39;49m[43mto[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdevice[49m[43m)[49m[43m)[49m
[1;32m    236[0m     [38;5;66;03m### TODO: Move into BaseModel in OCP 2.0[39;00m
[1;32m    237[0m     outputs [38;5;241m=[39m {}

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/nn/modules/module.py:1511[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1509[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1510[0m [38;5;28;01melse[39;00m:
[0;32m-> 1511[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/nn/modules/module.py:1520[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1515[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1516[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1517[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1518[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1519[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1520[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1522[0m [38;5;28;01mtry[39;00m:
[1;32m   1523[0m     result [38;5;241m=[39m [38;5;28;01mNone[39;00m

File [0;32m~/work/ocp/ocp/ocpmodels/common/utils.py:141[0m, in [0;36mconditional_grad.<locals>.decorator.<locals>.cls_method[0;34m(self, *args, **kwargs)[0m
[1;32m    139[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mregress_forces [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28mgetattr[39m([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mdirect_forces[39m[38;5;124m"[39m, [38;5;241m0[39m):
[1;32m    140[0m     f [38;5;241m=[39m dec(func)
[0;32m--> 141[0m [38;5;28;01mreturn[39;00m [43mf[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/work/ocp/ocp/ocpmodels/models/gemnet_oc/gemnet_oc.py:1226[0m, in [0;36mGemNetOC.forward[0;34m(self, data)[0m
[1;32m   1204[0m (
[1;32m   1205[0m     main_graph,
[1;32m   1206[0m     a2a_graph,
[0;32m   (...)[0m
[1;32m   1213[0m     quad_idx,
[1;32m   1214[0m ) [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mget_graphs_and_indices(data)
[1;32m   1215[0m _, idx_t [38;5;241m=[39m main_graph[[38;5;124m"[39m[38;5;124medge_index[39m[38;5;124m"[39m]
[1;32m   1217[0m (
[1;32m   1218[0m     basis_rad_raw,
[1;32m   1219[0m     basis_atom_update,
[1;32m   1220[0m     basis_output,
[1;32m   1221[0m     bases_qint,
[1;32m   1222[0m     bases_e2e,
[1;32m   1223[0m     bases_a2e,
[1;32m   1224[0m     bases_e2a,
[1;32m   1225[0m     basis_a2a_rad,
[0;32m-> 1226[0m ) [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mget_bases[49m[43m([49m
[1;32m   1227[0m [43m    [49m[43mmain_graph[49m[38;5;241;43m=[39;49m[43mmain_graph[49m[43m,[49m
[1;32m   1228[0m [43m    [49m[43ma2a_graph[49m[38;5;241;43m=[39;49m[43ma2a_graph[49m[43m,[49m
[1;32m   1229[0m [43m    [49m[43ma2ee2a_graph[49m[38;5;241;43m=[39;49m[43ma2ee2a_graph[49m[43m,[49m
[1;32m   1230[0m [43m    [49m[43mqint_graph[49m[38;5;241;43m=[39;49m[43mqint_graph[49m[43m,[49m
[1;32m   1231[0m [43m    [49m[43mtrip_idx_e2e[49m[38;5;241;43m=[39;49m[43mtrip_idx_e2e[49m[43m,[49m
[1;32m   1232[0m [43m    [49m[43mtrip_idx_a2e[49m[38;5;241;43m=[39;49m[43mtrip_idx_a2e[49m[43m,[49m
[1;32m   1233[0m [43m    [49m[43mtrip_idx_e2a[49m[38;5;241;43m=[39;49m[43mtrip_idx_e2a[49m[43m,[49m
[1;32m   1234[0m [43m    [49m[43mquad_idx[49m[38;5;241;43m=[39;49m[43mquad_idx[49m[43m,[49m
[1;32m   1235[0m [43m    [49m[43mnum_atoms[49m[38;5;241;43m=[39;49m[43mnum_atoms[49m[43m,[49m
[1;32m   1236[0m [43m[49m[43m)[49m
[1;32m   1238[0m [38;5;66;03m# Embedding block[39;00m
[1;32m   1239[0m h [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39matom_emb(atomic_numbers)

File [0;32m~/work/ocp/ocp/ocpmodels/models/gemnet_oc/gemnet_oc.py:1099[0m, in [0;36mGemNetOC.get_bases[0;34m(self, main_graph, a2a_graph, a2ee2a_graph, qint_graph, trip_idx_e2e, trip_idx_a2e, trip_idx_e2a, quad_idx, num_atoms)[0m
[1;32m   1090[0m     cosφ_cab_q, cosφ_abd, angle_cabd [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcalculate_quad_angles(
[1;32m   1091[0m         main_graph[[38;5;124m"[39m[38;5;124mvector[39m[38;5;124m"[39m],
[1;32m   1092[0m         qint_graph[[38;5;124m"[39m[38;5;124mvector[39m[38;5;124m"[39m],
[1;32m   1093[0m         quad_idx,
[1;32m   1094[0m     )
[1;32m   1096[0m     basis_rad_cir_qint_raw, basis_cir_qint_raw [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcbf_basis_qint(
[1;32m   1097[0m         qint_graph[[38;5;124m"[39m[38;5;124mdistance[39m[38;5;124m"[39m], cosφ_abd
[1;32m   1098[0m     )
[0;32m-> 1099[0m     basis_rad_sph_qint_raw, basis_sph_qint_raw [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msbf_basis_qint[49m[43m([49m
[1;32m   1100[0m [43m        [49m[43mmain_graph[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mdistance[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m
[1;32m   1101[0m [43m        [49m[43mcosφ_cab_q[49m[43m[[49m[43mquad_idx[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mtrip_out_to_quad[39;49m[38;5;124;43m"[39;49m[43m][49m[43m][49m[43m,[49m
[1;32m   1102[0m [43m        [49m[43mangle_cabd[49m[43m,[49m
[1;32m   1103[0m [43m    [49m[43m)[49m
[1;32m   1104[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39matom_edge_interaction:
[1;32m   1105[0m     basis_rad_a2ee2a_raw [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mradial_basis_aeaint(a2ee2a_graph[[38;5;124m"[39m[38;5;124mdistance[39m[38;5;124m"[39m])

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/nn/modules/module.py:1511[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1509[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1510[0m [38;5;28;01melse[39;00m:
[0;32m-> 1511[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/nn/modules/module.py:1520[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1515[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1516[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1517[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1518[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1519[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1520[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1522[0m [38;5;28;01mtry[39;00m:
[1;32m   1523[0m     result [38;5;241m=[39m [38;5;28;01mNone[39;00m

File [0;32m~/work/ocp/ocp/ocpmodels/models/gemnet_oc/layers/spherical_basis.py:132[0m, in [0;36mSphericalBasisLayer.forward[0;34m(self, D_ca, cosφ_cab, θ_cabd)[0m
[1;32m    130[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, D_ca, cosφ_cab, θ_cabd):
[1;32m    131[0m     rad_basis [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mradial_basis(D_ca)
[0;32m--> 132[0m     sph_basis [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mspherical_basis[49m[43m([49m[43mcosφ_cab[49m[43m,[49m[43m [49m[43mθ_cabd[49m[43m)[49m
[1;32m    133[0m     [38;5;66;03m# (num_quadruplets, num_spherical**2)[39;00m
[1;32m    135[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mscale_basis:

File [0;32m~/work/ocp/ocp/ocpmodels/models/gemnet_oc/layers/spherical_basis.py:116[0m, in [0;36mSphericalBasisLayer.__init__.<locals>.<lambda>[0;34m(cosφ, θ)[0m
[1;32m    111[0m [38;5;28;01melif[39;00m sbf_name [38;5;241m==[39m [38;5;124m"[39m[38;5;124mlegendre_outer[39m[38;5;124m"[39m:
[1;32m    112[0m     circular_basis [38;5;241m=[39m get_sph_harm_basis(num_spherical, zero_m_only[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m    113[0m     [38;5;28mself[39m[38;5;241m.[39mspherical_basis [38;5;241m=[39m [38;5;28;01mlambda[39;00m cosφ, ϑ: [43m([49m
[1;32m    114[0m [43m        [49m[43mcircular_basis[49m[43m([49m[43mcosφ[49m[43m)[49m[43m[[49m[43m:[49m[43m,[49m[43m [49m[43m:[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m][49m
[1;32m    115[0m [43m        [49m[38;5;241;43m*[39;49m[43m [49m[43mcircular_basis[49m[43m([49m[43mtorch[49m[38;5;241;43m.[39;49m[43mcos[49m[43m([49m[43mϑ[49m[43m)[49m[43m)[49m[43m[[49m[43m:[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[43m:[49m[43m][49m
[0;32m--> 116[0m [43m    [49m[43m)[49m[38;5;241;43m.[39;49m[43mreshape[49m[43m([49m[43mcosφ[49m[38;5;241;43m.[39;49m[43mshape[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m,[49m[43m [49m[38;5;241;43m-[39;49m[38;5;241;43m1[39;49m[43m)[49m
[1;32m    118[0m [38;5;28;01melif[39;00m sbf_name [38;5;241m==[39m [38;5;124m"[39m[38;5;124mgaussian_outer[39m[38;5;124m"[39m:
[1;32m    119[0m     [38;5;28mself[39m[38;5;241m.[39mcircular_basis [38;5;241m=[39m GaussianBasis(
[1;32m    120[0m         start[38;5;241m=[39m[38;5;241m-[39m[38;5;241m1[39m, stop[38;5;241m=[39m[38;5;241m1[39m, num_gaussians[38;5;241m=[39mnum_spherical, [38;5;241m*[39m[38;5;241m*[39msbf_hparams
[1;32m    121[0m     )

[0;31mRuntimeError[0m: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous

