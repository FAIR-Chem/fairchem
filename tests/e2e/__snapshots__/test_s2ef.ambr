# name: test_e2e_s2ef
  tuple(
    20,
    1,
  )
# ---
# name: test_e2e_s2ef.1
  tuple(
    20,
    13,
    3,
  )
# ---
# name: test_e2e_s2ef.2
  Approx(
  	array([[-87.44],
  	       [-86.8 ],
  	       [-86.44],
  	       [-84.9 ],
  	       [-78.5 ],
  	       [-79.8 ],
  	       [-80.2 ],
  	       [-79.4 ],
  	       [-79.4 ],
  	       [-78.7 ],
  	       [-78.2 ],
  	       [-81.4 ],
  	       [-82.  ],
  	       [-82.4 ],
  	       [-82.44],
  	       [-82.5 ],
  	       [-82.6 ],
  	       [-81.94],
  	       [-80.  ],
  	       [-80.8 ]], dtype=float16)
  )
# ---
# name: test_e2e_s2ef.3
  Approx(
  	array([[[-1.6943e-01, -2.2246e+00, -1.7217e+00],
  	        [-1.2607e+00,  7.2803e-01, -2.7786e-02],
  	        [ 1.8418e+00,  1.2588e+00, -1.7217e+00],
  	        [-8.3594e-01,  4.8242e-01, -2.2412e-01],
  	        [-6.9434e-01,  4.0088e-01, -1.1250e+00],
  	        [-2.0117e+00, -6.8281e+00, -1.3447e+00],
  	        [ 2.6831e-01, -1.5491e-01,  5.4150e-01],
  	        [ 4.9062e+00,  5.1562e+00, -1.3447e+00],
  	        [ 6.0889e-01, -4.7791e-02, -2.2539e+00],
  	        [ 3.4570e-01, -5.0342e-01, -2.2539e+00],
  	        [-6.4502e-01,  3.7256e-01, -3.2461e+00],
  	        [ 7.4219e+00, -4.2852e+00, -2.2891e+00],
  	        [-7.5547e+00,  4.3594e+00,  7.3008e+00]],
  	
  	       [[-9.0698e-02, -1.5762e+00, -1.2822e+00],
  	        [-6.2744e-01,  3.6206e-01,  3.0243e-02],
  	        [ 1.3193e+00,  8.6621e-01, -1.2822e+00],
  	        [-8.3057e-01,  4.7998e-01, -3.5669e-01],
  	        [-5.1904e-01,  2.9956e-01, -7.3096e-01],
  	        [-1.6484e+00, -5.6797e+00, -6.9824e-01],
  	        [ 3.7183e-01, -2.1460e-01,  8.6670e-01],
  	        [ 4.0938e+00,  4.2656e+00, -6.9775e-01],
  	        [ 4.9438e-01, -2.0923e-01, -2.0996e+00],
  	        [ 4.2847e-01, -3.2373e-01, -2.0996e+00],
  	        [-6.3477e-01,  3.6694e-01, -3.2910e+00],
  	        [ 6.0898e+00, -3.5156e+00, -1.8438e+00],
  	        [-8.1484e+00,  4.7070e+00,  6.3672e+00]],
  	
  	       [[-6.8054e-02, -1.3027e+00, -1.1582e+00],
  	        [-3.5864e-01,  2.0654e-01,  4.5502e-02],
  	        [ 1.0938e+00,  7.0996e-01, -1.1582e+00],
  	        [-8.4961e-01,  4.9097e-01, -3.9258e-01],
  	        [-4.8047e-01,  2.7734e-01, -6.3623e-01],
  	        [-1.6377e+00, -5.5234e+00, -5.1318e-01],
  	        [ 4.4165e-01, -2.5488e-01,  8.7598e-01],
  	        [ 3.9629e+00,  4.1797e+00, -5.1318e-01],
  	        [ 4.2651e-01, -1.4795e-01, -2.0859e+00],
  	        [ 3.4131e-01, -2.9565e-01, -2.0859e+00],
  	        [-5.4785e-01,  3.1689e-01, -3.3066e+00],
  	        [ 5.7812e+00, -3.3379e+00, -1.8428e+00],
  	        [-8.4688e+00,  4.8867e+00,  6.1562e+00]],
  	
  	       [[-1.3757e-01, -8.3252e-01, -4.8389e-01],
  	        [ 1.2091e-01, -6.9153e-02, -3.3813e-02],
  	        [ 6.5137e-01,  5.3467e-01, -4.8340e-01],
  	        [-1.0703e+00,  6.1865e-01, -4.1846e-01],
  	        [-2.3547e-01,  1.3501e-01, -2.6831e-01],
  	        [-1.1152e+00, -4.3672e+00,  3.3997e-02],
  	        [ 3.2080e-01, -1.8433e-01,  3.4790e-01],
  	        [ 3.2188e+00,  3.1426e+00,  3.6530e-02],
  	        [ 2.9126e-01,  2.5220e-01, -1.6982e+00],
  	        [-7.2571e-02, -3.7817e-01, -1.6973e+00],
  	        [-2.1973e-01,  1.2524e-01, -3.2285e+00],
  	        [ 5.1953e+00, -2.9980e+00, -2.1582e+00],
  	        [-8.9531e+00,  5.1680e+00,  5.7227e+00]],
  	
  	       [[-2.9004e-01, -6.3672e-01, -1.9568e-01],
  	        [ 2.4277e+00, -1.4062e+00, -7.8418e-01],
  	        [ 4.0869e-01,  5.6250e-01, -1.9751e-01],
  	        [-1.5732e+00,  9.0820e-01, -3.6768e-01],
  	        [ 6.0840e-01, -3.4961e-01,  8.3057e-01],
  	        [-4.5825e-01, -8.1665e-02,  8.9893e-01],
  	        [ 1.7017e-01, -9.9487e-02,  4.3066e-01],
  	        [-1.7542e-01,  4.2065e-01,  8.9697e-01],
  	        [ 2.3621e-01, -3.0518e-01, -6.1670e-01],
  	        [ 3.8281e-01, -5.3253e-02, -6.1328e-01],
  	        [-1.6387e+00,  9.3506e-01, -2.5742e+00],
  	        [ 3.2734e+00, -1.8857e+00, -3.2969e+00],
  	        [-1.4383e+01,  8.2969e+00,  6.3008e+00]],
  	
  	       [[ 1.7456e-01, -8.5010e-01, -6.2793e-01],
  	        [ 1.9912e+00, -1.1494e+00, -1.6836e+00],
  	        [ 8.1641e-01,  2.7954e-01, -6.2500e-01],
  	        [-3.0518e-01,  1.8359e-01, -4.6899e-01],
  	        [ 1.0626e-01, -6.2103e-02, -1.3252e+00],
  	        [-5.2227e+00, -7.9844e+00,  8.8525e-01],
  	        [-7.4609e-01,  4.3164e-01,  7.8662e-01],
  	        [ 4.2070e+00,  8.3594e+00,  8.8428e-01],
  	        [-1.2803e+00, -9.4287e-01, -1.7705e+00],
  	        [ 1.4905e-01,  1.5908e+00, -1.7842e+00],
  	        [-4.1309e-01,  2.3230e-01, -2.1113e+00],
  	        [ 5.9688e+00, -3.4473e+00, -3.2500e+00],
  	        [-1.1672e+01,  6.6758e+00,  1.7119e+00]],
  	
  	       [[ 1.6040e-01, -9.1211e-01, -4.1260e-01],
  	        [ 2.1191e+00, -1.2314e+00, -1.8330e+00],
  	        [ 8.6572e-01,  3.2080e-01, -4.0869e-01],
  	        [-8.5449e-01,  5.0488e-01, -8.4668e-01],
  	        [ 4.9683e-02, -3.5645e-02, -5.7471e-01],
  	        [-3.9492e+00, -5.8672e+00,  8.5596e-01],
  	        [-1.2812e+00,  7.4365e-01, -5.4016e-02],
  	        [ 2.9668e+00,  6.1445e+00,  8.6426e-01],
  	        [-1.0420e+00, -7.5537e-01, -1.5078e+00],
  	        [ 1.1530e-01,  1.3125e+00, -1.5127e+00],
  	        [-6.4258e-01,  3.6084e-01, -1.1016e+00],
  	        [ 5.5078e+00, -3.1738e+00, -3.5508e+00],
  	        [-1.2328e+01,  7.0625e+00,  2.4805e+00]],
  	
  	       [[ 1.3672e-01, -8.3936e-01, -2.9834e-01],
  	        [ 2.0938e+00, -1.2090e+00, -1.9980e+00],
  	        [ 7.9102e-01,  3.0273e-01, -2.9517e-01],
  	        [-5.1465e-01,  3.0078e-01, -9.2773e-01],
  	        [ 9.9030e-03, -1.0300e-02, -4.8755e-01],
  	        [-5.9023e+00, -9.2109e+00,  9.0039e-01],
  	        [-1.0264e+00,  5.9814e-01,  1.4062e-01],
  	        [ 4.9180e+00,  9.5547e+00,  9.0137e-01],
  	        [-7.2559e-01, -6.1914e-01, -1.4346e+00],
  	        [ 1.6626e-01,  9.4824e-01, -1.4453e+00],
  	        [-6.5918e-01,  3.7598e-01, -8.5986e-01],
  	        [ 5.9883e+00, -3.4590e+00, -3.4043e+00],
  	        [-1.2852e+01,  7.3867e+00,  8.0469e-01]],
  	
  	       [[ 1.6089e-01, -5.9863e-01, -8.6609e-02],
  	        [ 1.6289e+00, -9.3994e-01, -2.6895e+00],
  	        [ 6.0254e-01,  1.6418e-01, -8.8318e-02],
  	        [-3.3252e-01,  1.9043e-01, -7.6025e-01],
  	        [ 5.4749e-02, -3.3295e-02, -1.8481e-01],
  	        [-3.1973e+00, -2.8672e+00,  4.6777e-01],
  	        [-5.7324e-01,  3.3936e-01,  5.6006e-01],
  	        [ 8.8086e-01,  4.2266e+00,  4.5337e-01],
  	        [-9.4189e-01,  8.6304e-02, -1.0840e+00],
  	        [-5.2686e-01,  7.6465e-01, -1.0801e+00],
  	        [-4.4263e-01,  2.6196e-01, -1.2217e+00],
  	        [ 6.3711e+00, -3.6758e+00, -2.5762e+00],
  	        [-1.2961e+01,  7.4805e+00, -2.9844e+00]],
  	
  	       [[ 1.4856e-01, -4.9683e-01, -8.7463e-02],
  	        [ 1.0781e+00, -6.2598e-01, -2.9551e+00],
  	        [ 5.0879e-01,  1.2903e-01, -8.8684e-02],
  	        [-3.7744e-01,  2.1643e-01, -6.9922e-01],
  	        [ 1.2708e-01, -7.6843e-02,  8.6914e-02],
  	        [-2.6504e+00, -1.6270e+00,  3.5132e-01],
  	        [-6.7041e-01,  4.0259e-01,  3.7964e-01],
  	        [ 1.2482e-01,  3.2402e+00,  3.3447e-01],
  	        [-4.9609e-01, -1.2604e-02, -1.2842e+00],
  	        [-2.1875e-01,  4.2407e-01, -1.2676e+00],
  	        [-6.3916e-01,  3.7964e-01, -1.5137e+00],
  	        [ 5.7109e+00, -3.3066e+00, -2.3926e+00],
  	        [-1.2914e+01,  7.4453e+00, -2.6465e+00]],
  	
  	       [[ 3.4595e-01, -6.5479e-01, -1.7224e-01],
  	        [ 1.4863e+00, -8.6426e-01, -2.6914e+00],
  	        [ 7.4121e-01,  3.5736e-02, -1.7542e-01],
  	        [-1.9873e-01,  1.1810e-01, -2.6880e-01],
  	        [ 3.1641e-01, -1.8457e-01,  3.1104e-01],
  	        [-3.8770e+00, -2.7871e+00,  2.5708e-01],
  	        [ 7.0996e-01, -3.9771e-01,  1.4414e+00],
  	        [ 4.6045e-01,  4.7539e+00,  2.4097e-01],
  	        [-1.1553e+00,  2.3621e-01, -1.6426e+00],
  	        [-7.6025e-01,  8.7500e-01, -1.6289e+00],
  	        [-2.3352e-01,  1.3342e-01, -2.7441e+00],
  	        [ 5.6875e+00, -3.2852e+00, -2.1113e+00],
  	        [-1.3367e+01,  7.6992e+00, -3.2773e+00]],
  	
  	       [[ 5.2148e-01, -4.9292e-01, -1.4221e-01],
  	        [ 1.8994e+00, -1.1074e+00, -1.9678e+00],
  	        [ 6.7529e-01, -1.9812e-01, -1.4734e-01],
  	        [ 4.9902e-01, -2.8491e-01,  5.5811e-01],
  	        [ 5.0830e-01, -2.8052e-01, -3.4424e-01],
  	        [-1.2070e+00,  2.6191e+00, -1.0605e+00],
  	        [ 2.4434e+00, -1.4277e+00,  1.2852e+00],
  	        [-2.8613e+00, -2.4194e-01, -1.0303e+00],
  	        [-1.3125e+00, -1.0762e+00, -2.2793e+00],
  	        [ 2.8687e-01,  1.6748e+00, -2.2871e+00],
  	        [ 2.2144e-01, -1.3062e-01, -3.2188e+00],
  	        [ 3.1016e+00, -1.7930e+00, -1.3594e+00],
  	        [-1.2219e+01,  7.0859e+00, -4.2656e+00]],
  	
  	       [[ 5.0439e-01, -4.7510e-01, -1.7603e-01],
  	        [ 1.8633e+00, -1.0908e+00, -1.9434e+00],
  	        [ 6.4844e-01, -1.9324e-01, -1.8127e-01],
  	        [ 4.6631e-01, -2.6855e-01,  6.1523e-01],
  	        [ 5.6689e-01, -3.0957e-01, -3.0005e-01],
  	        [-1.9043e+00,  1.9551e+00, -9.7705e-01],
  	        [ 2.2578e+00, -1.3184e+00,  1.2041e+00],
  	        [-2.6406e+00,  6.5674e-01, -9.6191e-01],
  	        [-1.2520e+00, -1.2227e+00, -2.2832e+00],
  	        [ 4.4531e-01,  1.6934e+00, -2.2910e+00],
  	        [ 1.1304e-01, -7.2998e-02, -3.1230e+00],
  	        [ 2.6973e+00, -1.5576e+00, -1.1250e+00],
  	        [-1.0914e+01,  6.3320e+00, -4.1133e+00]],
  	
  	       [[ 4.9780e-01, -4.2139e-01, -1.7334e-01],
  	        [ 1.8291e+00, -1.0732e+00, -1.9404e+00],
  	        [ 5.9814e-01, -2.1423e-01, -1.7859e-01],
  	        [ 4.3188e-01, -2.5000e-01,  6.5088e-01],
  	        [ 5.6055e-01, -3.0298e-01, -2.8906e-01],
  	        [-2.2793e+00,  1.5186e+00, -8.0908e-01],
  	        [ 2.0156e+00, -1.1787e+00,  1.0654e+00],
  	        [-2.4473e+00,  1.2012e+00, -7.9541e-01],
  	        [-1.1836e+00, -1.2842e+00, -2.2559e+00],
  	        [ 5.3174e-01,  1.6650e+00, -2.2656e+00],
  	        [ 2.6291e-02, -2.3529e-02, -3.1016e+00],
  	        [ 2.4141e+00, -1.3936e+00, -1.0586e+00],
  	        [-9.8750e+00,  5.7305e+00, -4.0156e+00]],
  	
  	       [[ 4.9829e-01, -4.1479e-01, -1.7236e-01],
  	        [ 1.8252e+00, -1.0713e+00, -1.9424e+00],
  	        [ 5.9229e-01, -2.1777e-01, -1.7761e-01],
  	        [ 4.2773e-01, -2.4792e-01,  6.5381e-01],
  	        [ 5.5713e-01, -3.0054e-01, -2.8784e-01],
  	        [-2.3145e+00,  1.4727e+00, -7.8809e-01],
  	        [ 1.9883e+00, -1.1621e+00,  1.0498e+00],
  	        [-2.4258e+00,  1.2549e+00, -7.7490e-01],
  	        [-1.1748e+00, -1.2852e+00, -2.2520e+00],
  	        [ 5.3711e-01,  1.6582e+00, -2.2637e+00],
  	        [ 1.6098e-02, -1.7654e-02, -3.1016e+00],
  	        [ 2.3848e+00, -1.3770e+00, -1.0527e+00],
  	        [-9.7578e+00,  5.6641e+00, -4.0039e+00]],
  	
  	       [[ 4.7559e-01, -4.0186e-01, -1.8042e-01],
  	        [ 1.7949e+00, -1.0537e+00, -1.8926e+00],
  	        [ 5.6934e-01, -2.0471e-01, -1.8591e-01],
  	        [ 4.0112e-01, -2.3279e-01,  6.6504e-01],
  	        [ 5.8984e-01, -3.1860e-01, -3.0688e-01],
  	        [-2.5234e+00,  1.2119e+00, -6.8164e-01],
  	        [ 1.9639e+00, -1.1465e+00,  1.0410e+00],
  	        [-2.3047e+00,  1.5645e+00, -6.6846e-01],
  	        [-1.1963e+00, -1.4883e+00, -2.2656e+00],
  	        [ 7.0117e-01,  1.7803e+00, -2.2773e+00],
  	        [-1.2428e-02,  2.3997e-04, -3.0996e+00],
  	        [ 2.1172e+00, -1.2207e+00, -1.0596e+00],
  	        [-9.3203e+00,  5.4102e+00, -3.9844e+00]],
  	
  	       [[ 4.2041e-01, -3.2690e-01, -2.0825e-01],
  	        [ 1.6436e+00, -9.6826e-01, -1.7461e+00],
  	        [ 4.7559e-01, -1.9434e-01, -2.1411e-01],
  	        [ 3.3179e-01, -1.9360e-01,  6.9238e-01],
  	        [ 6.2793e-01, -3.3838e-01, -4.0601e-01],
  	        [-3.2617e+00,  3.1250e-01, -2.3364e-01],
  	        [ 1.8955e+00, -1.1035e+00,  9.7510e-01],
  	        [-1.8916e+00,  2.6523e+00, -2.1997e-01],
  	        [-1.2656e+00, -2.0625e+00, -2.3301e+00],
  	        [ 1.1592e+00,  2.1309e+00, -2.3379e+00],
  	        [-8.8806e-02,  4.8859e-02, -3.1016e+00],
  	        [ 1.3301e+00, -7.6367e-01, -1.1406e+00],
  	        [-8.1250e+00,  4.7148e+00, -3.9492e+00]],
  	
  	       [[ 3.7671e-01, -1.9934e-01, -2.7979e-01],
  	        [ 1.4893e+00, -8.8086e-01, -1.5830e+00],
  	        [ 3.4155e-01, -2.2034e-01, -2.8467e-01],
  	        [ 1.4636e-01, -8.7463e-02,  8.0859e-01],
  	        [ 5.3564e-01, -2.8955e-01, -4.6313e-01],
  	        [-3.3184e+00,  1.4111e-01,  1.4075e-01],
  	        [ 1.3037e+00, -7.5342e-01,  4.5898e-01],
  	        [-1.7471e+00,  2.8379e+00,  1.6760e-01],
  	        [-1.3398e+00, -2.5098e+00, -2.4199e+00],
  	        [ 1.4951e+00,  2.4160e+00, -2.4199e+00],
  	        [-2.1765e-01,  1.2842e-01, -3.0996e+00],
  	        [-4.3970e-01,  2.5977e-01, -1.4268e+00],
  	        [-5.2422e+00,  3.0605e+00, -4.0820e+00]],
  	
  	       [[ 1.8628e-01,  9.1492e-02, -3.4180e-01],
  	        [ 1.2236e+00, -7.1826e-01, -1.2373e+00],
  	        [ 7.2384e-04, -2.0532e-01, -3.4644e-01],
  	        [-1.3647e-01,  8.3191e-02,  1.1738e+00],
  	        [ 5.4297e-01, -2.9907e-01, -7.9529e-02],
  	        [-3.3125e+00, -7.3486e-02,  7.7930e-01],
  	        [-3.2501e-02,  1.8890e-02, -5.1855e-01],
  	        [-1.5898e+00,  2.8770e+00,  7.8711e-01],
  	        [-1.3936e+00, -2.6367e+00, -2.4355e+00],
  	        [ 1.5771e+00,  2.5254e+00, -2.4180e+00],
  	        [-2.9736e-01,  1.8616e-01, -2.9473e+00],
  	        [ 2.0723e+00, -1.1973e+00, -1.2090e+00],
  	        [ 1.1798e-01, -6.2500e-02, -6.2031e+00]],
  	
  	       [[ 3.3887e-01, -9.7900e-02, -2.9907e-01],
  	        [ 1.4531e+00, -8.5791e-01, -1.5068e+00],
  	        [ 2.3608e-01, -2.3938e-01, -3.0420e-01],
  	        [ 9.8816e-02, -5.9509e-02,  8.4277e-01],
  	        [ 5.3955e-01, -2.9272e-01, -3.7305e-01],
  	        [-3.1641e+00,  2.9077e-01,  1.8286e-01],
  	        [ 2.0801e-01, -1.1853e-01, -1.3281e-01],
  	        [-1.8047e+00,  2.6289e+00,  2.0667e-01],
  	        [-1.3604e+00, -2.8398e+00, -2.5215e+00],
  	        [ 1.7646e+00,  2.5957e+00, -2.5137e+00],
  	        [-2.6562e-01,  1.5894e-01, -3.0723e+00],
  	        [-4.7583e-01,  2.7954e-01, -1.4258e+00],
  	        [-4.6875e+00,  2.7402e+00, -6.4531e+00]]], dtype=float16)
  )
# ---
