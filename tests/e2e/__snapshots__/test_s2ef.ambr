# name: test_e2e_s2ef
  tuple(
    20,
    1,
  )
# ---
# name: test_e2e_s2ef.1
  tuple(
    20,
    13,
    3,
  )
# ---
# name: test_e2e_s2ef.2
  Approx(
  	array([[2.916],
  	       [2.898],
  	       [2.898],
  	       [2.904],
  	       [2.781],
  	       [2.527],
  	       [2.588],
  	       [2.535],
  	       [2.393],
  	       [2.373],
  	       [2.402],
  	       [2.48 ],
  	       [2.47 ],
  	       [2.463],
  	       [2.463],
  	       [2.469],
  	       [2.506],
  	       [2.63 ],
  	       [2.84 ],
  	       [2.691]], dtype=float16)
  )
# ---
# name: test_e2e_s2ef.3
  Approx(
  	array([[[-2.1992e-03, -8.2214e-02,  1.6858e-01],
  	        [ 1.0522e-01, -6.0730e-02,  1.1835e-01],
  	        [ 7.0129e-02,  4.3030e-02,  1.6858e-01],
  	        [-1.6851e-03,  9.7227e-04,  1.2305e-01],
  	        [ 1.7288e-02, -9.9869e-03,  1.9238e-01],
  	        [-5.6030e-02,  9.9609e-02,  2.0361e-01],
  	        [-6.3721e-02,  3.6804e-02,  2.1851e-01],
  	        [-1.1426e-01, -1.2913e-03,  2.0361e-01],
  	        [-5.0415e-02,  6.7749e-02, -3.2788e-01],
  	        [-8.3862e-02,  9.7733e-03, -3.2788e-01],
  	        [ 2.1652e-02, -1.2497e-02, -2.5854e-01],
  	        [ 1.8872e-01, -1.0895e-01, -2.6758e-01],
  	        [ 4.2114e-01, -2.4316e-01, -2.9102e-01]],
  	
  	       [[ 6.7940e-03, -1.1475e-01,  1.4783e-01],
  	        [ 1.0364e-01, -5.9845e-02,  1.1981e-01],
  	        [ 1.0278e-01,  5.1483e-02,  1.4783e-01],
  	        [ 1.2337e-02, -7.1106e-03,  1.2341e-01],
  	        [ 1.4328e-02, -8.2703e-03,  1.9006e-01],
  	        [-6.3660e-02,  1.0468e-01,  1.7761e-01],
  	        [-9.0698e-02,  5.2368e-02,  1.9202e-01],
  	        [-1.2256e-01,  2.7390e-03,  1.7761e-01],
  	        [-6.5674e-02,  9.5947e-02, -3.1128e-01],
  	        [-1.1584e-01,  8.9417e-03, -3.1128e-01],
  	        [ 2.1408e-02, -1.2321e-02, -2.3694e-01],
  	        [ 6.2549e-01, -3.6108e-01, -3.4326e-01],
  	        [-7.8369e-02,  4.5258e-02, -2.4011e-01]],
  	
  	       [[ 9.3384e-03, -1.1993e-01,  1.4392e-01],
  	        [ 1.0199e-01, -5.8899e-02,  1.1963e-01],
  	        [ 1.0852e-01,  5.1880e-02,  1.4392e-01],
  	        [ 1.3634e-02, -7.8583e-03,  1.2305e-01],
  	        [ 1.3420e-02, -7.7515e-03,  1.8970e-01],
  	        [-6.6284e-02,  1.0345e-01,  1.7212e-01],
  	        [-9.8083e-02,  5.6641e-02,  1.8103e-01],
  	        [-1.2286e-01,  5.6152e-03,  1.7212e-01],
  	        [-6.9885e-02,  1.0303e-01, -3.0591e-01],
  	        [-1.2415e-01,  9.0561e-03, -3.0591e-01],
  	        [ 2.0721e-02, -1.1909e-02, -2.3108e-01],
  	        [ 7.4268e-01, -4.2896e-01, -3.6328e-01],
  	        [-2.0251e-01,  1.1694e-01, -2.1399e-01]],
  	
  	       [[ 1.4412e-02, -1.2335e-01,  1.3599e-01],
  	        [ 9.0820e-02, -5.2460e-02,  1.1365e-01],
  	        [ 1.1401e-01,  4.9164e-02,  1.3599e-01],
  	        [ 5.2948e-03, -3.0613e-03,  1.2280e-01],
  	        [ 1.0635e-02, -6.1378e-03,  1.8530e-01],
  	        [-5.4810e-02,  9.2529e-02,  1.4673e-01],
  	        [-1.2085e-01,  6.9763e-02,  1.2048e-01],
  	        [-1.0773e-01,  1.1292e-03,  1.4685e-01],
  	        [-7.8552e-02,  1.0602e-01, -2.7441e-01],
  	        [-1.3110e-01,  1.5038e-02, -2.7417e-01],
  	        [ 7.8430e-03, -4.7493e-03, -1.8909e-01],
  	        [ 7.1191e-01, -4.1138e-01, -3.3838e-01],
  	        [-1.9446e-01,  1.1218e-01, -1.8665e-01]],
  	
  	       [[ 2.8336e-02, -1.0651e-01,  1.0077e-01],
  	        [ 5.8685e-02, -3.3966e-02,  8.7585e-02],
  	        [ 1.0645e-01,  2.8641e-02,  1.0077e-01],
  	        [-1.4732e-02,  8.4915e-03,  1.2317e-01],
  	        [-1.2833e-02,  7.4310e-03,  1.3892e-01],
  	        [ 6.5689e-03,  1.0223e-01,  8.5327e-02],
  	        [-1.7798e-01,  1.0266e-01, -5.8624e-02],
  	        [-8.5815e-02, -5.6946e-02,  8.5632e-02],
  	        [-1.0394e-01,  9.2407e-02, -1.2878e-01],
  	        [-1.3208e-01,  4.3823e-02, -1.2842e-01],
  	        [-7.0801e-03,  3.1376e-03, -5.6366e-02],
  	        [ 4.8340e-01, -2.8027e-01, -2.6147e-01],
  	        [-1.1584e-01,  6.7566e-02,  5.6091e-02]],
  	
  	       [[ 1.4359e-02, -1.2924e-02,  1.4381e-02],
  	        [-2.4357e-03,  1.3723e-03,  7.7209e-02],
  	        [ 1.8173e-02, -4.9744e-03,  1.4549e-02],
  	        [-7.4829e-02,  4.3182e-02,  1.6248e-01],
  	        [ 5.6839e-03, -3.2024e-03,  3.0670e-02],
  	        [ 4.6204e-02,  3.4149e-02,  6.5796e-02],
  	        [-1.4453e-01,  8.3069e-02, -7.0435e-02],
  	        [-6.7558e-03, -5.6305e-02,  6.6223e-02],
  	        [-1.0840e-01, -5.5603e-02,  1.6772e-01],
  	        [-5.8517e-03,  1.2170e-01,  1.6870e-01],
  	        [-7.3792e-02,  4.0192e-02,  2.5708e-01],
  	        [ 1.1121e-01, -6.6223e-02, -1.9922e-01],
  	        [ 7.8430e-03, -7.3929e-03, -5.6580e-02]],
  	
  	       [[ 2.2827e-02, -4.4434e-02,  4.0161e-02],
  	        [ 1.6693e-02, -9.7504e-03,  6.6833e-02],
  	        [ 4.9866e-02,  2.9602e-03,  4.0283e-02],
  	        [-5.2582e-02,  3.0334e-02,  1.4880e-01],
  	        [-2.7542e-03,  1.6365e-03,  5.9631e-02],
  	        [ 3.4973e-02,  5.4962e-02,  7.2205e-02],
  	        [-1.7627e-01,  1.0144e-01, -1.0529e-01],
  	        [-3.0518e-02, -5.7159e-02,  7.2571e-02],
  	        [-1.1115e-01, -8.2550e-03,  1.0120e-01],
  	        [-4.8370e-02,  1.0046e-01,  1.0211e-01],
  	        [-5.3680e-02,  2.9114e-02,  1.6992e-01],
  	        [ 1.8628e-01, -1.0944e-01, -2.0178e-01],
  	        [ 9.6054e-03, -7.7591e-03, -4.9316e-02]],
  	
  	       [[ 1.7487e-02, -3.5126e-02,  3.1952e-02],
  	        [ 1.0788e-02, -6.4545e-03,  6.3416e-02],
  	        [ 3.8971e-02,  2.7885e-03,  3.1952e-02],
  	        [-5.9418e-02,  3.4271e-02,  1.4868e-01],
  	        [-4.0436e-03,  2.4376e-03,  4.9957e-02],
  	        [ 4.2572e-02,  4.7424e-02,  6.4026e-02],
  	        [-7.5378e-02,  4.3365e-02,  8.6212e-03],
  	        [-2.0035e-02, -6.0181e-02,  6.4270e-02],
  	        [-9.3323e-02, -1.9409e-02,  9.3994e-02],
  	        [-2.8992e-02,  8.9844e-02,  9.4116e-02],
  	        [-4.6021e-02,  2.5604e-02,  1.3928e-01],
  	        [ 1.3147e-01, -7.7209e-02, -1.9885e-01],
  	        [-9.3262e-02,  5.1697e-02, -1.5039e-01]],
  	
  	       [[-7.1487e-03, -3.7556e-03,  6.6643e-03],
  	        [ 3.7659e-02, -2.2018e-02,  7.3608e-02],
  	        [-9.6321e-04,  8.4076e-03,  6.2675e-03],
  	        [-7.6965e-02,  4.4525e-02,  1.4502e-01],
  	        [-1.6136e-03,  8.8453e-04,  1.5259e-02],
  	        [ 8.9722e-02,  7.6660e-02,  4.1321e-02],
  	        [ 1.6980e-01, -9.7778e-02,  2.3242e-01],
  	        [-2.1637e-02, -1.1688e-01,  4.1168e-02],
  	        [-3.6652e-02, -5.0446e-02,  7.6477e-02],
  	        [ 2.8412e-02,  5.3864e-02,  7.5134e-02],
  	        [-2.8198e-02,  1.7349e-02,  4.6082e-02],
  	        [ 4.5815e-03, -2.6531e-03, -1.6284e-01],
  	        [-2.8857e-01,  1.6553e-01, -2.5220e-01]],
  	
  	       [[-1.7899e-02,  8.9340e-03, -4.6730e-03],
  	        [ 5.0140e-02, -2.9053e-02,  7.8552e-02],
  	        [-1.7441e-02,  1.1505e-02, -5.2185e-03],
  	        [-8.3923e-02,  4.8645e-02,  1.4355e-01],
  	        [-1.0843e-03,  4.3082e-04, -2.3043e-04],
  	        [ 1.1487e-01,  1.0107e-01,  2.9861e-02],
  	        [ 2.0410e-01, -1.1743e-01,  2.4438e-01],
  	        [-3.0106e-02, -1.5125e-01,  2.9663e-02],
  	        [-7.5340e-03, -5.5756e-02,  7.1411e-02],
  	        [ 4.8401e-02,  3.0182e-02,  6.9580e-02],
  	        [-2.2720e-02,  1.4809e-02,  6.4087e-03],
  	        [-4.4891e-02,  2.6367e-02, -1.3916e-01],
  	        [-3.4058e-01,  1.9568e-01, -2.3511e-01]],
  	
  	       [[-1.7118e-03,  1.0842e-04, -8.8959e-03],
  	        [ 3.6438e-02, -2.0996e-02,  9.9182e-02],
  	        [-1.4677e-03,  1.8702e-03, -9.1553e-03],
  	        [-8.0566e-02,  4.6600e-02,  1.3184e-01],
  	        [-5.3253e-03,  2.8458e-03, -5.7106e-03],
  	        [ 1.2476e-01,  9.7595e-02,  6.7825e-03],
  	        [ 2.2473e-01, -1.2939e-01,  2.4536e-01],
  	        [-2.1896e-02, -1.5784e-01,  6.4125e-03],
  	        [-2.3666e-02, -6.0547e-02,  1.1162e-02],
  	        [ 4.3640e-02,  4.6478e-02,  1.0330e-02],
  	        [-1.5518e-02,  9.9411e-03, -6.2866e-02],
  	        [ 2.0004e-02, -1.0262e-02, -1.5588e-01],
  	        [-3.5889e-01,  2.0630e-01, -2.0190e-01]],
  	
  	       [[ 3.1586e-02, -8.7891e-03, -1.5343e-02],
  	        [ 7.4921e-03, -3.9177e-03,  1.5112e-01],
  	        [ 2.3071e-02, -2.2629e-02, -1.5022e-02],
  	        [-6.1066e-02,  3.4851e-02,  8.7891e-02],
  	        [-9.5520e-03,  5.2643e-03, -1.4984e-02],
  	        [ 1.0565e-01,  3.7720e-02, -3.8055e-02],
  	        [ 2.4963e-01, -1.4380e-01,  2.0227e-01],
  	        [ 2.0691e-02, -1.1108e-01, -3.8818e-02],
  	        [-6.9580e-02, -4.4647e-02, -1.2238e-01],
  	        [ 4.2648e-03,  7.7576e-02, -1.2128e-01],
  	        [ 1.2703e-02, -8.0109e-03, -1.4453e-01],
  	        [-1.2732e-01,  7.7271e-02, -1.4185e-01],
  	        [-3.1128e-01,  1.7969e-01, -8.9050e-02]],
  	
  	       [[ 3.6377e-02, -7.9041e-03, -1.4397e-02],
  	        [ 8.6899e-03, -4.5357e-03,  1.5637e-01],
  	        [ 2.4628e-02, -2.7237e-02, -1.4015e-02],
  	        [-5.7098e-02,  3.2471e-02,  7.9651e-02],
  	        [-8.8501e-03,  4.8523e-03, -1.9119e-02],
  	        [ 1.0175e-01,  3.8544e-02, -4.2450e-02],
  	        [ 2.1436e-01, -1.2347e-01,  1.6833e-01],
  	        [ 1.8082e-02, -1.0797e-01, -4.3213e-02],
  	        [-7.7148e-02, -3.2532e-02, -1.3489e-01],
  	        [-1.0056e-02,  7.8125e-02, -1.3367e-01],
  	        [ 1.7014e-02, -1.0597e-02, -1.4478e-01],
  	        [-1.8042e-01,  1.0797e-01, -1.3025e-01],
  	        [-1.8445e-01,  1.0645e-01, -7.7759e-02]],
  	
  	       [[ 3.9215e-02, -8.4305e-03, -1.4374e-02],
  	        [ 7.8659e-03, -3.9978e-03,  1.5869e-01],
  	        [ 2.6443e-02, -2.9465e-02, -1.3947e-02],
  	        [-5.4443e-02,  3.0869e-02,  7.4341e-02],
  	        [-8.7357e-03,  4.7798e-03, -2.1866e-02],
  	        [ 1.0114e-01,  3.8788e-02, -4.5898e-02],
  	        [ 1.8665e-01, -1.0742e-01,  1.4392e-01],
  	        [ 1.7578e-02, -1.0754e-01, -4.6692e-02],
  	        [-8.1604e-02, -2.3956e-02, -1.4197e-01],
  	        [-1.9730e-02,  7.7698e-02, -1.4062e-01],
  	        [ 1.9760e-02, -1.2230e-02, -1.4429e-01],
  	        [-1.9958e-01,  1.1902e-01, -1.2573e-01],
  	        [-8.7585e-02,  5.0323e-02, -7.6233e-02]],
  	
  	       [[ 3.9490e-02, -8.5678e-03, -1.4412e-02],
  	        [ 7.7591e-03, -3.9291e-03,  1.5894e-01],
  	        [ 2.6688e-02, -2.9633e-02, -1.3977e-02],
  	        [-5.4169e-02,  3.0701e-02,  7.3792e-02],
  	        [-8.7204e-03,  4.7722e-03, -2.2156e-02],
  	        [ 1.0101e-01,  3.8727e-02, -4.6234e-02],
  	        [ 1.8359e-01, -1.0565e-01,  1.4136e-01],
  	        [ 1.7593e-02, -1.0742e-01, -4.7028e-02],
  	        [-8.2031e-02, -2.3026e-02, -1.4270e-01],
  	        [-2.0752e-02,  7.7576e-02, -1.4136e-01],
  	        [ 2.0050e-02, -1.2421e-02, -1.4429e-01],
  	        [-2.0081e-01,  1.1975e-01, -1.2537e-01],
  	        [-7.7393e-02,  4.4434e-02, -7.6172e-02]],
  	
  	       [[ 4.0131e-02, -8.9264e-03, -1.5030e-02],
  	        [ 5.3978e-03, -2.6398e-03,  1.5833e-01],
  	        [ 2.7298e-02, -3.0014e-02, -1.4587e-02],
  	        [-5.1208e-02,  2.8946e-02,  7.0129e-02],
  	        [-8.5373e-03,  4.6806e-03, -2.3575e-02],
  	        [ 1.0022e-01,  3.7018e-02, -4.7211e-02],
  	        [ 1.7053e-01, -9.8206e-02,  1.2988e-01],
  	        [ 1.8661e-02, -1.0590e-01, -4.8004e-02],
  	        [-8.0750e-02, -1.9989e-02, -1.4429e-01],
  	        [-2.2659e-02,  7.5317e-02, -1.4294e-01],
  	        [ 2.0721e-02, -1.2886e-02, -1.4392e-01],
  	        [-1.9836e-01,  1.1823e-01, -1.2250e-01],
  	        [-3.4576e-02,  1.9592e-02, -7.7576e-02]],
  	
  	       [[ 4.1321e-02, -1.1597e-02, -1.7441e-02],
  	        [ 2.1191e-03, -9.8419e-04,  1.5698e-01],
  	        [ 3.0136e-02, -2.9694e-02, -1.6998e-02],
  	        [-4.1687e-02,  2.3361e-02,  5.8807e-02],
  	        [-7.4158e-03,  4.0932e-03, -2.8107e-02],
  	        [ 9.3811e-02,  2.7237e-02, -4.7943e-02],
  	        [ 1.3208e-01, -7.6050e-02,  9.6802e-02],
  	        [ 2.3865e-02, -9.5520e-02, -4.8798e-02],
  	        [-7.6233e-02, -1.0750e-02, -1.4832e-01],
  	        [-2.8076e-02,  6.7688e-02, -1.4697e-01],
  	        [ 2.2980e-02, -1.4450e-02, -1.4282e-01],
  	        [-1.7810e-01,  1.0626e-01, -1.1285e-01],
  	        [ 6.9702e-02, -4.0985e-02, -7.9102e-02]],
  	
  	       [[ 4.1046e-02, -1.8555e-02, -2.2614e-02],
  	        [ 6.1607e-03, -3.8357e-03,  1.5466e-01],
  	        [ 3.6011e-02, -2.5955e-02, -2.2186e-02],
  	        [-2.0035e-02,  1.0704e-02,  3.4424e-02],
  	        [-3.5934e-03,  2.0733e-03, -3.8147e-02],
  	        [ 7.1838e-02, -2.5654e-03, -4.3884e-02],
  	        [ 4.2328e-02, -2.4384e-02,  2.7420e-02],
  	        [ 3.8666e-02, -6.1676e-02, -4.4800e-02],
  	        [-6.5918e-02,  8.3084e-03, -1.5259e-01],
  	        [-3.8910e-02,  5.1117e-02, -1.5125e-01],
  	        [ 2.7695e-02, -1.7639e-02, -1.3879e-01],
  	        [-1.3208e-01,  7.9346e-02, -9.6802e-02],
  	        [ 1.5845e-01, -9.2712e-02, -5.3680e-02]],
  	
  	       [[ 3.5431e-02, -3.7689e-02, -3.2867e-02],
  	        [ 1.9135e-02, -1.2619e-02,  1.4417e-01],
  	        [ 4.9988e-02, -1.1612e-02, -3.2440e-02],
  	        [ 1.6357e-02, -1.0368e-02, -1.1620e-02],
  	        [ 6.8245e-03, -3.4504e-03, -5.9326e-02],
  	        [ 8.4961e-02,  3.4008e-03, -5.7373e-02],
  	        [-1.4417e-01,  8.3069e-02, -1.0370e-01],
  	        [ 4.0558e-02, -7.5012e-02, -5.8105e-02],
  	        [-4.9011e-02,  4.9377e-02, -1.4929e-01],
  	        [-6.5491e-02,  1.9119e-02, -1.4844e-01],
  	        [ 3.3417e-02, -2.1805e-02, -1.2524e-01],
  	        [-6.9031e-02,  4.2847e-02, -8.0811e-02],
  	        [ 2.0129e-01, -1.1847e-01,  4.8248e-02]],
  	
  	       [[ 4.0009e-02, -2.1912e-02, -2.4918e-02],
  	        [ 8.9493e-03, -5.7182e-03,  1.5295e-01],
  	        [ 3.8422e-02, -2.3392e-02, -2.4490e-02],
  	        [-9.4147e-03,  4.5357e-03,  2.2552e-02],
  	        [-1.3676e-03,  8.9741e-04, -4.3121e-02],
  	        [ 6.4087e-02, -1.3313e-02, -4.2511e-02],
  	        [-8.6288e-03,  4.9438e-03, -8.4381e-03],
  	        [ 4.4220e-02, -4.9408e-02, -4.3427e-02],
  	        [-6.1279e-02,  1.7120e-02, -1.5308e-01],
  	        [-4.4037e-02,  4.3518e-02, -1.5186e-01],
  	        [ 2.9587e-02, -1.8936e-02, -1.3611e-01],
  	        [-1.1243e-01,  6.7871e-02, -9.1675e-02],
  	        [ 1.6370e-01, -9.5825e-02, -3.9581e-02]]], dtype=float16)
  )
# ---
