# name: test_e2e_s2ef
  tuple(
    20,
    1,
  )
# ---
# name: test_e2e_s2ef.1
  tuple(
    20,
    13,
    3,
  )
# ---
# name: test_e2e_s2ef.2
  Approx(
  	array([[-3.824],
  	       [-3.86 ],
  	       [-3.871],
  	       [-3.996],
  	       [-4.324],
  	       [-4.008],
  	       [-4.2  ],
  	       [-4.23 ],
  	       [-4.355],
  	       [-4.363],
  	       [-4.258],
  	       [-2.973],
  	       [-2.824],
  	       [-2.77 ],
  	       [-2.766],
  	       [-2.744],
  	       [-2.748],
  	       [-2.984],
  	       [-3.232],
  	       [-3.146]], dtype=float16)
  )
# ---
# name: test_e2e_s2ef.3
  Approx(
  	array([[[-1.1304e-01,  4.2505e-01, -1.7812e+00],
  	        [ 9.3359e-01, -5.3906e-01,  3.7598e-01],
  	        [-4.2456e-01, -1.1469e-01, -1.7812e+00],
  	        [ 1.2656e+00, -7.3047e-01,  4.6851e-01],
  	        [ 5.6519e-02, -3.2623e-02, -1.9570e+00],
  	        [ 6.3428e-01,  9.8486e-01,  3.0444e-01],
  	        [-8.8623e-01,  5.1172e-01, -2.6465e+00],
  	        [-5.3564e-01, -1.0420e+00,  3.0444e-01],
  	        [ 4.2383e-01, -1.3193e+00, -3.1738e-01],
  	        [ 1.3545e+00,  2.9248e-01, -3.1738e-01],
  	        [-3.9624e-01,  2.2876e-01, -2.5879e-01],
  	        [-4.1040e-01,  2.3694e-01, -6.4148e-02],
  	        [ 8.6562e+00, -4.9961e+00,  9.6973e-01]],
  	
  	       [[-1.2207e-01,  4.2993e-01, -1.5537e+00],
  	        [ 1.1045e+00, -6.3770e-01,  3.5620e-01],
  	        [-4.3359e-01, -1.0925e-01, -1.5537e+00],
  	        [ 1.3398e+00, -7.7344e-01,  4.5483e-01],
  	        [ 6.4819e-02, -3.7384e-02, -1.6904e+00],
  	        [ 5.5859e-01,  5.9326e-01,  1.4905e-01],
  	        [-1.1562e+00,  6.6797e-01, -2.6211e+00],
  	        [-2.3389e-01, -7.7979e-01,  1.4893e-01],
  	        [ 4.5166e-01, -1.2705e+00, -3.8794e-01],
  	        [ 1.3262e+00,  2.4402e-01, -3.8794e-01],
  	        [-4.3286e-01,  2.4976e-01, -3.1421e-01],
  	        [-2.7344e-01,  1.5784e-01, -6.7200e-02],
  	        [ 9.9219e+00, -5.7305e+00,  3.7573e-01]],
  	
  	       [[-1.2360e-01,  4.2798e-01, -1.4912e+00],
  	        [ 1.1084e+00, -6.3965e-01,  3.4985e-01],
  	        [-4.3262e-01, -1.0693e-01, -1.4912e+00],
  	        [ 1.3770e+00, -7.9492e-01,  4.5068e-01],
  	        [ 6.6223e-02, -3.8177e-02, -1.6162e+00],
  	        [ 5.1709e-01,  4.6094e-01,  1.0425e-01],
  	        [-1.2197e+00,  7.0459e-01, -2.5977e+00],
  	        [-1.4001e-01, -6.7773e-01,  1.0413e-01],
  	        [ 4.6045e-01, -1.2598e+00, -4.0503e-01],
  	        [ 1.3213e+00,  2.3096e-01, -4.0479e-01],
  	        [-4.4043e-01,  2.5415e-01, -3.2935e-01],
  	        [-2.4695e-01,  1.4258e-01, -7.2815e-02],
  	        [ 1.0266e+01, -5.9297e+00,  2.2388e-01]],
  	
  	       [[-1.2134e-01,  3.6670e-01, -1.1484e+00],
  	        [ 1.2695e+00, -7.3242e-01,  3.0713e-01],
  	        [-3.7891e-01, -7.9224e-02, -1.1484e+00],
  	        [ 1.4053e+00, -8.1104e-01,  4.1406e-01],
  	        [ 6.1798e-02, -3.5645e-02, -1.1895e+00],
  	        [ 2.1741e-01,  2.8906e-01,  4.1107e-02],
  	        [-1.2490e+00,  7.2070e-01, -2.2266e+00],
  	        [-1.4185e-01, -3.3447e-01,  4.1016e-02],
  	        [ 4.7852e-01, -1.2979e+00, -5.0195e-01],
  	        [ 1.3633e+00,  2.3450e-01, -5.0195e-01],
  	        [-4.3774e-01,  2.5269e-01, -4.3506e-01],
  	        [-2.8271e-01,  1.6418e-01, -3.4637e-02],
  	        [ 1.0172e+01, -5.8711e+00,  3.3203e-02]],
  	
  	       [[-8.9233e-02,  2.1896e-02, -6.9580e-02],
  	        [ 1.8496e+00, -1.0664e+00,  5.0537e-02],
  	        [-6.4880e-02,  5.9723e-02, -7.0129e-02],
  	        [ 1.4727e+00, -8.5010e-01,  1.5515e-01],
  	        [ 2.2873e-02, -1.2978e-02,  6.9824e-02],
  	        [-8.1738e-01, -2.4622e-01, -1.7322e-01],
  	        [-1.4092e+00,  8.1152e-01, -1.2002e+00],
  	        [-1.9983e-01,  8.2227e-01, -1.7261e-01],
  	        [ 5.0293e-01, -1.3516e+00, -8.2275e-01],
  	        [ 1.4219e+00,  2.4072e-01, -8.2373e-01],
  	        [-3.5010e-01,  2.0276e-01, -7.8613e-01],
  	        [-2.1216e-01,  1.2549e-01,  7.0679e-02],
  	        [ 9.9453e+00, -5.7422e+00, -2.5854e-01]],
  	
  	       [[-5.5206e-02, -7.5879e-01,  1.5010e+00],
  	        [ 2.5762e+00, -1.4893e+00, -7.7441e-01],
  	        [ 6.2695e-01,  4.0576e-01,  1.4990e+00],
  	        [ 1.1396e+00, -6.5381e-01, -4.3579e-01],
  	        [ 2.9160e-02, -1.6876e-02,  1.2832e+00],
  	        [-2.3184e+00, -8.8623e-01, -3.4155e-01],
  	        [-3.6934e+00,  2.1250e+00, -2.5254e+00],
  	        [-4.0601e-01,  2.4434e+00, -3.3716e-01],
  	        [ 1.7004e-01, -1.1875e+00, -1.5566e+00],
  	        [ 1.1143e+00,  4.4800e-01, -1.5596e+00],
  	        [-1.7468e-01,  9.9670e-02, -1.5029e+00],
  	        [ 4.6680e-01, -2.6538e-01,  2.1997e-01],
  	        [ 1.0375e+01, -5.9844e+00,  7.6233e-02]],
  	
  	       [[-4.8950e-02, -6.0498e-01,  1.2324e+00],
  	        [ 2.4863e+00, -1.4365e+00, -5.6055e-01],
  	        [ 4.9756e-01,  3.2666e-01,  1.2314e+00],
  	        [ 1.2822e+00, -7.3730e-01, -3.3740e-01],
  	        [-1.0498e-02,  6.3820e-03,  1.1953e+00],
  	        [-2.0195e+00, -7.6660e-01, -3.4180e-01],
  	        [-2.8262e+00,  1.6260e+00, -1.8174e+00],
  	        [-3.5767e-01,  2.1211e+00, -3.3838e-01],
  	        [ 2.6904e-01, -1.2139e+00, -1.3555e+00],
  	        [ 1.1855e+00,  3.7500e-01, -1.3584e+00],
  	        [-1.8445e-01,  1.0638e-01, -1.3340e+00],
  	        [ 3.5303e-01, -1.9983e-01,  1.7029e-01],
  	        [ 1.0133e+01, -5.8477e+00, -1.0242e-01]],
  	
  	       [[ 7.3242e-02, -5.1562e-01,  1.3613e+00],
  	        [ 2.5039e+00, -1.4424e+00, -5.9521e-01],
  	        [ 4.8267e-01,  1.7969e-01,  1.3613e+00],
  	        [ 1.2949e+00, -7.4951e-01, -3.5205e-01],
  	        [ 1.3049e-01, -7.9346e-02,  1.1895e+00],
  	        [-2.2305e+00, -8.5596e-01, -2.7441e-01],
  	        [-3.2676e+00,  1.8838e+00, -2.2520e+00],
  	        [-3.8306e-01,  2.3574e+00, -2.7393e-01],
  	        [ 2.2839e-01, -1.1543e+00, -1.3721e+00],
  	        [ 1.1143e+00,  3.7915e-01, -1.3730e+00],
  	        [-1.1597e-01,  6.6467e-02, -1.3320e+00],
  	        [ 4.6704e-01, -2.6660e-01,  1.6162e-01],
  	        [ 1.0805e+01, -6.2305e+00,  6.0181e-02]],
  	
  	       [[ 4.1748e-01, -2.8711e-01,  1.6475e+00],
  	        [ 2.6484e+00, -1.5137e+00, -6.7725e-01],
  	        [ 4.6289e-01, -2.2363e-01,  1.6553e+00],
  	        [ 1.3633e+00, -8.0273e-01, -3.9502e-01],
  	        [ 5.2734e-01, -3.1909e-01,  1.1426e+00],
  	        [-2.7930e+00, -1.1562e+00, -9.9426e-02],
  	        [-3.4453e+00,  1.9912e+00, -2.4258e+00],
  	        [-4.0161e-01,  3.0117e+00, -1.0565e-01],
  	        [ 1.2659e-01, -1.0117e+00, -1.4463e+00],
  	        [ 9.3994e-01,  3.9307e-01, -1.4395e+00],
  	        [ 5.3925e-02, -3.1403e-02, -1.3008e+00],
  	        [ 4.9658e-01, -2.8491e-01,  1.8286e-01],
  	        [ 1.3500e+01, -7.7930e+00,  4.8535e-01]],
  	
  	       [[ 5.5908e-01, -2.1753e-01,  1.7354e+00],
  	        [ 2.7559e+00, -1.5723e+00, -7.0264e-01],
  	        [ 4.7607e-01, -3.7817e-01,  1.7441e+00],
  	        [ 1.3926e+00, -8.2568e-01, -4.3677e-01],
  	        [ 6.9336e-01, -4.1870e-01,  1.1201e+00],
  	        [-2.9219e+00, -1.1475e+00, -4.2389e-02],
  	        [-3.0918e+00,  1.7891e+00, -2.1348e+00],
  	        [-4.7388e-01,  3.1211e+00, -5.1666e-02],
  	        [ 7.1594e-02, -9.8633e-01, -1.5029e+00],
  	        [ 8.9014e-01,  4.2749e-01, -1.4932e+00],
  	        [ 1.0602e-01, -6.1005e-02, -1.2744e+00],
  	        [ 4.6509e-01, -2.6660e-01,  2.0850e-01],
  	        [ 1.4586e+01, -8.4141e+00,  4.8584e-01]],
  	
  	       [[ 5.7520e-01, -7.5073e-02,  1.7080e+00],
  	        [ 2.7285e+00, -1.5674e+00, -8.0762e-01],
  	        [ 3.6743e-01, -4.6094e-01,  1.7148e+00],
  	        [ 1.2441e+00, -7.3730e-01, -4.0771e-01],
  	        [ 8.4668e-01, -5.0684e-01,  1.1357e+00],
  	        [-2.7598e+00, -5.6250e-01,  3.5889e-02],
  	        [-4.0977e+00,  2.3672e+00, -2.6992e+00],
  	        [-9.0527e-01,  2.6777e+00,  2.6825e-02],
  	        [ 8.0444e-02, -8.5156e-01, -1.4141e+00],
  	        [ 7.7246e-01,  3.5156e-01, -1.4053e+00],
  	        [ 1.2732e-01, -7.3181e-02, -1.2070e+00],
  	        [ 2.1838e-01, -1.2634e-01,  2.5146e-01],
  	        [ 1.5016e+01, -8.6797e+00,  1.2195e-01]],
  	
  	       [[ 3.1445e-01,  4.6191e-01,  1.6680e+00],
  	        [ 2.4844e+00, -1.4658e+00, -9.9512e-01],
  	        [-2.1790e-01, -4.9854e-01,  1.6699e+00],
  	        [ 1.1572e+00, -6.8164e-01, -3.0371e-01],
  	        [ 1.2119e+00, -7.1729e-01,  1.1885e+00],
  	        [-1.1045e+00,  2.6758e+00, -5.3027e-01],
  	        [-3.4922e+00,  2.0078e+00, -1.4180e+00],
  	        [-2.8984e+00, -4.4922e-01, -5.5029e-01],
  	        [-4.1473e-02, -9.2627e-01, -1.0029e+00],
  	        [ 7.5928e-01,  4.8560e-01, -9.9561e-01],
  	        [ 9.1309e-02, -5.4871e-02, -9.1309e-01],
  	        [ 1.5947e+00, -9.2676e-01,  3.6646e-01],
  	        [ 1.4930e+01, -8.5938e+00,  1.8369e+00]],
  	
  	       [[ 2.6611e-01,  5.0391e-01,  1.6562e+00],
  	        [ 2.5527e+00, -1.5068e+00, -9.9707e-01],
  	        [-2.7930e-01, -4.7852e-01,  1.6592e+00],
  	        [ 1.1689e+00, -6.8750e-01, -2.9492e-01],
  	        [ 1.2695e+00, -7.4951e-01,  1.1885e+00],
  	        [-1.2588e+00,  2.4590e+00, -5.1318e-01],
  	        [-1.5645e+00,  8.9795e-01, -2.3474e-01],
  	        [-2.7812e+00, -1.9775e-01, -5.3125e-01],
  	        [-1.7487e-02, -9.9365e-01, -9.3652e-01],
  	        [ 8.2764e-01,  4.9756e-01, -9.2920e-01],
  	        [ 1.0815e-01, -6.4331e-02, -8.7549e-01],
  	        [ 1.4336e+00, -8.3203e-01,  4.0356e-01],
  	        [ 1.4117e+01, -8.1172e+00,  2.0762e+00]],
  	
  	       [[ 2.3364e-01,  5.3369e-01,  1.6494e+00],
  	        [ 2.5801e+00, -1.5244e+00, -9.9463e-01],
  	        [-3.2178e-01, -4.6606e-01,  1.6533e+00],
  	        [ 1.1836e+00, -6.9580e-01, -2.9736e-01],
  	        [ 1.3076e+00, -7.7100e-01,  1.1875e+00],
  	        [-1.3047e+00,  2.3691e+00, -5.0928e-01],
  	        [-7.4902e-01,  4.2822e-01,  1.5137e-01],
  	        [-2.7207e+00, -1.0315e-01, -5.2490e-01],
  	        [-6.0997e-03, -1.0381e+00, -9.0186e-01],
  	        [ 8.7061e-01,  5.0977e-01, -8.9453e-01],
  	        [ 1.1963e-01, -7.0801e-02, -8.5059e-01],
  	        [ 1.3379e+00, -7.7686e-01,  4.3530e-01],
  	        [ 1.3586e+01, -7.8125e+00,  2.1758e+00]],
  	
  	       [[ 2.3022e-01,  5.3711e-01,  1.6494e+00],
  	        [ 2.5820e+00, -1.5264e+00, -9.9463e-01],
  	        [-3.2617e-01, -4.6484e-01,  1.6523e+00],
  	        [ 1.1855e+00, -6.9678e-01, -2.9810e-01],
  	        [ 1.3125e+00, -7.7344e-01,  1.1875e+00],
  	        [-1.3066e+00,  2.3613e+00, -5.0928e-01],
  	        [-6.8604e-01,  3.9209e-01,  1.7468e-01],
  	        [-2.7148e+00, -9.7229e-02, -5.2490e-01],
  	        [-5.0430e-03, -1.0420e+00, -8.9844e-01],
  	        [ 8.7500e-01,  5.1074e-01, -8.9111e-01],
  	        [ 1.2091e-01, -7.1411e-02, -8.4766e-01],
  	        [ 1.3271e+00, -7.7051e-01,  4.3896e-01],
  	        [ 1.3531e+01, -7.7812e+00,  2.1855e+00]],
  	
  	       [[ 2.0984e-01,  5.6055e-01,  1.6631e+00],
  	        [ 2.5508e+00, -1.5059e+00, -1.0098e+00],
  	        [-3.5767e-01, -4.5996e-01,  1.6670e+00],
  	        [ 1.1641e+00, -6.8359e-01, -3.0933e-01],
  	        [ 1.3311e+00, -7.8320e-01,  1.1855e+00],
  	        [-1.3154e+00,  2.3008e+00, -4.9731e-01],
  	        [-6.6602e-01,  3.8184e-01,  1.1707e-01],
  	        [-2.6641e+00, -5.2399e-02, -5.1123e-01],
  	        [-5.5122e-03, -1.0605e+00, -8.8623e-01],
  	        [ 8.9111e-01,  5.2051e-01, -8.7939e-01],
  	        [ 1.3123e-01, -7.7148e-02, -8.4521e-01],
  	        [ 1.5781e+00, -9.1602e-01,  4.6167e-01],
  	        [ 1.3359e+01, -7.6797e+00,  2.2910e+00]],
  	
  	       [[ 1.5088e-01,  6.2891e-01,  1.7041e+00],
  	        [ 2.4648e+00, -1.4502e+00, -1.0459e+00],
  	        [-4.4800e-01, -4.4629e-01,  1.7080e+00],
  	        [ 1.1074e+00, -6.4844e-01, -3.5474e-01],
  	        [ 1.3887e+00, -8.1445e-01,  1.1797e+00],
  	        [-1.1914e+00,  2.2969e+00, -5.0977e-01],
  	        [-7.5195e-01,  4.3579e-01, -1.7041e-01],
  	        [-2.5918e+00, -1.3916e-01, -5.1807e-01],
  	        [-1.1841e-02, -1.1074e+00, -8.5693e-01],
  	        [ 9.3213e-01,  5.5176e-01, -8.5107e-01],
  	        [ 1.6162e-01, -9.3811e-02, -8.3594e-01],
  	        [ 2.2715e+00, -1.3174e+00,  5.4883e-01],
  	        [ 1.2789e+01, -7.3633e+00,  2.5469e+00]],
  	
  	       [[ 4.1504e-02,  7.2803e-01,  1.7734e+00],
  	        [ 2.3145e+00, -1.3486e+00, -1.0645e+00],
  	        [-5.9277e-01, -4.0747e-01,  1.7783e+00],
  	        [ 1.0059e+00, -5.8398e-01, -4.8486e-01],
  	        [ 1.5166e+00, -8.8379e-01,  1.1621e+00],
  	        [-4.3945e-01,  2.8691e+00, -7.3389e-01],
  	        [-1.8955e+00,  1.1055e+00, -1.2764e+00],
  	        [-2.7031e+00, -1.0508e+00, -7.3486e-01],
  	        [-7.1289e-02, -1.1611e+00, -8.4570e-01],
  	        [ 9.5898e-01,  6.3477e-01, -8.4229e-01],
  	        [ 2.1667e-01, -1.2311e-01, -8.0957e-01],
  	        [ 3.1895e+00, -1.8506e+00,  7.6416e-01],
  	        [ 1.1375e+01, -6.5703e+00,  2.3809e+00]],
  	
  	       [[-5.4901e-02,  6.4746e-01,  1.8242e+00],
  	        [ 1.7344e+00, -9.8828e-01, -1.0225e+00],
  	        [-5.8008e-01, -2.9395e-01,  1.8271e+00],
  	        [ 6.1182e-01, -3.4424e-01, -6.5771e-01],
  	        [ 1.7314e+00, -1.0000e+00,  1.0820e+00],
  	        [ 1.7212e-01,  2.6738e+00, -8.9600e-01],
  	        [-1.1884e-01,  8.9172e-02, -4.6289e-01],
  	        [-2.2363e+00, -1.5010e+00, -9.0332e-01],
  	        [-3.1885e-01, -5.2246e-01, -7.6514e-01],
  	        [ 2.9907e-01,  5.3418e-01, -7.6318e-01],
  	        [ 3.4058e-01, -1.8909e-01, -7.4854e-01],
  	        [ 3.3105e+00, -1.9160e+00,  8.3984e-01],
  	        [ 1.0234e+01, -5.9336e+00,  2.3184e+00]],
  	
  	       [[-4.2748e-04,  7.3633e-01,  1.7930e+00],
  	        [ 2.2305e+00, -1.2939e+00, -1.0518e+00],
  	        [-6.2256e-01, -3.7793e-01,  1.7969e+00],
  	        [ 9.3848e-01, -5.4248e-01, -5.4053e-01],
  	        [ 1.5771e+00, -9.1650e-01,  1.1465e+00],
  	        [-3.4332e-02,  3.1543e+00, -8.7500e-01],
  	        [-1.9600e+00,  1.1455e+00, -1.4141e+00],
  	        [-2.7480e+00, -1.5449e+00, -8.7598e-01],
  	        [-1.3672e-01, -1.0977e+00, -8.5107e-01],
  	        [ 8.7695e-01,  6.6211e-01, -8.4863e-01],
  	        [ 2.4304e-01, -1.3696e-01, -7.9541e-01],
  	        [ 3.3184e+00, -1.9238e+00,  8.3643e-01],
  	        [ 1.0859e+01, -6.2812e+00,  2.0918e+00]]], dtype=float16)
  )
# ---
